ylim(0,10000)+
theme_minimal()
ggplot(dat_yld, aes(inc, yld))+
geom_smooth(method="lm", fullrange=TRUE, se=F, size=0.7, color="grey80", aes(group = factor(study)))+
geom_point(alpha = 0.5, shape = 1)+
ylab("Yield (kg/ha)")+
xlab("White mold incidence (%)")+
theme_minimal()
dat_yld %>%
do(tidy(lm(.$yld ~ .$inc), conf.int=TRUE)) %>%
ggplot(aes(estimate))+
geom_histogram(bins = 10, fill = "grey90",  color="grey50")+
theme_minimal()+
facet_wrap(~term, scales = "free_x")
ggplot(dat_yld, aes(inc, yld))+
geom_smooth(method="lm", fullrange=TRUE, se=F, size=0.7, color="grey80", aes(group = factor(study)))+
geom_point(alpha = 0.5, shape = 1)+
ylab("Yield (kg/ha)")+
xlab("White mold incidence (%)")+
theme_minimal()
ggplot(dat_scl, aes(inc, scl))+
geom_smooth(method="lm", fullrange=TRUE, se=F, size=0.7, color="grey80", aes(group = factor(study)))+
geom_point(alpha = 0.5, shape = 1)+
ylab("Sclerotia weight (g/ha)")+
xlab("White mold incidence (%)")+
ylim(0,10000)+
theme_minimal()
ggplot(dat_yld, aes(inc, yld))+
geom_smooth(method="lm", fullrange=TRUE, se=F, size=0.7, color="grey80", aes(group = factor(study)))+
geom_point(alpha = 0.5, shape = 1)+
ylab("Yield (kg/ha)")+
xlab("White mold incidence (%)")+
theme_minimal()
dat_yld %>%
do(tidy(lm(.$yld ~ .$inc), conf.int=TRUE))
summary(dat_yld)
day_yld %>%
ggplot(aes(estimate))+
geom_histogram(bins = 10, fill = "grey90",  color="grey50")+
theme_minimal()+
facet_wrap(~term, scales = "free_x")
dat_yld %>%
do(tidy(lm(.$yld ~ .$inc), conf.int=TRUE))%>%
summary()
day_yld %>%
ggplot(aes(estimate))+
geom_histogram(bins = 10, fill = "grey90",  color="grey50")+
theme_minimal()+
facet_wrap(~term, scales = "free_x")
dat_yld %>%
do(tidy(lm(.$yld ~ .$inc), conf.int=TRUE))%>%
summary(estimate)
day_yld %>%
ggplot(aes(estimate))+
geom_histogram(bins = 10, fill = "grey90",  color="grey50")+
theme_minimal()+
facet_wrap(~term, scales = "free_x")
dat_yld %>%
do(tidy(lm(.$yld ~ .$inc), conf.int=TRUE))%>%
summary(.$estimate)
day_yld %>%
ggplot(aes(estimate))+
geom_histogram(bins = 10, fill = "grey90",  color="grey50")+
theme_minimal()+
facet_wrap(~term, scales = "free_x")
dat_yld %>%
do(tidy(lm(.$yld ~ .$inc), conf.int=TRUE))%>%
summary(.$estimate)
dat_yld %>%
ggplot(aes(estimate))+
geom_histogram(bins = 10, fill = "grey90",  color="grey50")+
theme_minimal()+
facet_wrap(~term, scales = "free_x")
dat_yld %>%
do(tidy(lm(.$yld ~ .$inc), conf.int=TRUE))%>%
summary(estimate)
dat_yld %>%
ggplot(aes(estimate))+
geom_histogram(bins = 10, fill = "grey90",  color="grey50")+
theme_minimal()+
facet_wrap(~term, scales = "free_x")
dat_yld_lm <- dat_yld %>%
do(tidy(lm(.$yld ~ .$inc), conf.int=TRUE))
dat_yld %>%
ggplot(aes(estimate))+
geom_histogram(bins = 10, fill = "grey90",  color="grey50")+
theme_minimal()+
facet_wrap(~term, scales = "free_x")
dat_yld_lm <- dat_yld %>%
do(tidy(lm(.$yld ~ .$inc), conf.int=TRUE))
dat_yld_lm %>%
ggplot(aes(estimate))+
geom_histogram(bins = 10, fill = "grey90",  color="grey50")+
theme_minimal()+
facet_wrap(~term, scales = "free_x")
dat_yld_lm <- dat_yld %>%
do(tidy(lm(.$yld ~ .$inc), conf.int=TRUE))
summary(dat_yld_lm$estimate)
dat_yld_lm %>%
ggplot(aes(estimate))+
geom_histogram(bins = 10, fill = "grey90",  color="grey50")+
theme_minimal()+
facet_wrap(~term, scales = "free_x")
dat_yld %>%
do(tidy(lm(.$yld ~ .$inc), conf.int=TRUE))
ggplot(aes(estimate))+
geom_histogram(bins = 10, fill = "grey90",  color="grey50")+
theme_minimal()+
facet_wrap(~term, scales = "free_x")
dat_yld %>%
do(tidy(lm(.$yld ~ .$inc), conf.int=TRUE)) %>%
ggplot(aes(estimate))+
geom_histogram(bins = 10, fill = "grey90",  color="grey50")+
theme_minimal()+
facet_wrap(~term, scales = "free_x")
dat_yld %>%
do(tidy(lm(.$yld ~ .$inc), conf.int=TRUE)) %>%
ggplot(aes(estimate))+
geom_histogram(bins = 10, fill = "grey90",  color="grey50")+
theme_minimal()+
facet_wrap(~term, scales = "free_x")
ggplot(dat_scl, aes(inc, scl))+
geom_smooth(method="lm", fullrange=TRUE, se=F, size=0.7, color="grey80", aes(group = factor(study)))+
geom_point(alpha = 0.5, shape = 1)+
ylab("Sclerotia weight (g/ha)")+
xlab("White mold incidence (%)")+
ylim(0,10000)+
theme_minimal()
library(lme4)
# random intercept and slopes
mix_yld1  <- lmer(yld ~ inc + (inc |study), data=dat_yld, REML=F)
# random slopes
mix_yld2 <- lmer(yld ~ inc + (1 | inc), data=dat_yld, REML=F)
# random intercepts
mix_yld3 <- lmer(yld ~ inc + (1 |study), data=dat_yld, REML=F)
library(lme4)
# random intercept and slopes
mix_yld1  <- lmer(yld ~ inc + (inc |study), data=dat_yld, REML=F)
# random slopes
mix_yld2 <- lmer(yld ~ inc + (1 | inc), data=dat_yld, REML=F)
# random intercepts
mix_yld3 <- lmer(yld ~ inc + (1 |study), data=dat_yld, REML=F)
AIC(mix_yld1, mix_yld2, mix_yld3)
vc <- VarCorr(mix_yld1)
print(vc,comp=c("Variance","Std.Dev."),digits=2)
vc <- VarCorr(mix_yld1)
## both variance and std.dev.
print(vc,comp=c("Variance","Std.Dev."),digits=2)
## variance only
as.data.frame(vc)
as.data.frame(vc,order="lower.tri")
VarCorr(mix_yld1)
## both variance and std.dev.
print(vc,comp=c("Variance","Std.Dev."),digits=2)
## variance only
as.data.frame(vc)
as.data.frame(vc,order="lower.tri")
VarCorr(mix_yld1)
## both variance and std.dev.
print(vc,comp=c("Variance","Std.Dev."),digits=2)
## variance only
as.data.frame(vc,order="lower.tri")
as.data.frame(vc)
print(vc,comp=c("Variance","Std.Dev."),digits=2)
as.data.frame(vc,comp=c("Variance","Std.Dev."),digits=2)
as.data.frame(vc,order="lower.tri")
vc <- VarCorr(mix_yld1)
## variance only
as.data.frame(vc,order="lower.tri")
# Get the p-values of the significance of the slope
library(car)
Anova(mix_yld1)
library(piecewiseSEM)
sem.model.fits(mix_yld1)
# quality of the fit
plot(mix_yld1,type=c("p","smooth"))
plot(mix_yld1,sqrt(abs(resid(.)))~fitted(.), type=c("p","smooth"))
library(lattice)
qqmath(mix_yld1)
plot(fitted(mix_yld1)~dat_yld$yld)
# quality of the fit
plot(mix_yld1,type=c("p","smooth"))
library(lattice)
qqmath(mix_yld1)
plot(fitted(mix_yld1)~dat_yld$yld)
ggplot(dat_scl, aes(inc, scl))+
geom_smooth(method="lm", fullrange=TRUE, se=F, size=0.7, color="grey80", aes(group = factor(study)))+
geom_point(alpha = 0.5, shape = 1)+
ylab("Sclerotia weight (g/ha)")+
xlab("White mold incidence (%)")+
ylim(0,10000)+
theme_minimal()
# extract the blups
cc2 <- coef(mix_yld1)$study
# calculate the interdecile ranges
summary(cc2)
dec90 <- quantile(cc2$`(Intercept)`,probs=c(.9))
dec10 <- quantile(cc2$`(Intercept)`,probs=c(.1))
dec90-dec10
dec90 <- quantile(cc2$inc,probs=c(.9))
dec10 <- quantile(cc2$inc,probs=c(.1))
dec90-dec10
summary(cc2$inc)
# extract the blups
cc2 <- coef(mix_yld1)$study
# calculate the interdecile ranges
dec90 <- quantile(cc2$`(Intercept)`,probs=c(.9))
dec10 <- quantile(cc2$`(Intercept)`,probs=c(.1))
dec90-dec10
dec90 <- quantile(cc2$inc,probs=c(.9))
dec10 <- quantile(cc2$inc,probs=c(.1))
dec90-dec10
dec90 <- quantile(cc2$`(Intercept)`,probs=c(.9))
dec10 <- quantile(cc2$`(Intercept)`,probs=c(.1))
dec90-dec10
# extract the blups
cc2 <- coef(mix_yld1)$study
# calculate the interdecile ranges
# Intercept
dec90 <- quantile(cc2$`(Intercept)`,probs=c(.9))
dec10 <- quantile(cc2$`(Intercept)`,probs=c(.1))
dec90-dec10
# Slopes
dec90 <- quantile(cc2$inc,probs=c(.9))
dec10 <- quantile(cc2$inc,probs=c(.1))
dec90-dec10
# extract the blups
cc2 <- coef(mix_yld1)$study
# calculate the interdecile ranges
# Intercept
dec90 <- quantile(cc2$`(Intercept)`,probs=c(.9))
dec10 <- quantile(cc2$`(Intercept)`,probs=c(.1))
print("Interecept", dec90-dec10)
# extract the blups
cc2 <- coef(mix_yld1)$study
# calculate the interdecile ranges
# Intercept
dec90 <- quantile(cc2$`(Intercept)`,probs=c(.9))
dec10 <- quantile(cc2$`(Intercept)`,probs=c(.1))
print("Intercept")
dec90-dec10)
# extract the blups
cc2 <- coef(mix_yld1)$study
# calculate the interdecile ranges
# Intercept
dec90 <- quantile(cc2$`(Intercept)`,probs=c(.9))
dec10 <- quantile(cc2$`(Intercept)`,probs=c(.1))
print("Intercept")
dec90-dec10
# Slopes
dec90 <- quantile(cc2$inc,probs=c(.9))
dec10 <- quantile(cc2$inc,probs=c(.1))
dec90-dec10
# extract the blups
cc2 <- coef(mix_yld1)$study
# calculate the interdecile ranges
# Intercept
dec90 <- quantile(cc2$`(Intercept)`,probs=c(.9))
dec10 <- quantile(cc2$`(Intercept)`,probs=c(.1))
print("Intercept interdecile range")
dec90-dec10
# Slopes
dec90 <- quantile(cc2$inc,probs=c(.9))
dec10 <- quantile(cc2$inc,probs=c(.1))
print("Slope interdecile range")
dec90-dec10
# extract the blups
cc2 <- coef(mix_yld1)$study
hist(cc2)
# calculate the interdecile ranges
# Intercept
dec90 <- quantile(cc2$`(Intercept)`,probs=c(.9))
dec10 <- quantile(cc2$`(Intercept)`,probs=c(.1))
print("Intercept interdecile range")
dec90-dec10
# Slopes
dec90 <- quantile(cc2$inc,probs=c(.9))
dec10 <- quantile(cc2$inc,probs=c(.1))
print("Slope interdecile range")
dec90-dec10
cc2
gather(cc2, 1:2)
gather(cc2, 1:2, "Coef", "Value")
gather(cc2, "Coef", "Value")
cc2 %>%
gather(cc2, "Coef", "Value") %>%
ggplot(aes(x = Value)=
# extract the blups
cc2 <- coef(mix_yld1)$study
cc2 %>%
gather(cc2, "Coef", "Value") %>%
ggplot(aes(x = Value))+
geom_histogram()+
facet_wrap(~Coef)
cc2 %>%
gather(cc2, "Coef", "Value") %>%
ggplot(aes(Value))+
geom_histogram()+
facet_wrap(~Coef)
cc2 %>%
gather(cc2, "Coef", "Value")
cc2 %>%
gather(cc2, "Coef", "Value")
cc2 %>%
gather(cc2, Coef, Value)
cc2 <- coef(mix_yld1)$study
cc2 %>%
gather(cc2, Coef, Value)
cc2
cc2 %>%
gather(cc2, "Coef", "Value")
cc2 %>%
gather(cc2, 1:2, "Coef", "Value")
cc2 %>%
gather(cc2, 2:3, "Coef", "Value")
View(cc2)
cc2 %>%
gather(cc2, "Coef", "Value")
?gather
cc2 %>%
gather(cc2, "Coef")
cc2 %>%
gather(cc2, "Coef")
cc2 <- coef(mix_yld1)$study
cc2 %>%
gather("coef", "value") %>%
ggplot(aes(x=value))+
geom_histogram()+
facet_wrap(~coef)
# extract the blups
cc2 <- coef(mix_yld1)$study
cc2 %>%
gather("coef", "value") %>%
ggplot(aes(x=value))+
geom_histogram()+
facet_wrap(~coef, scales = "free_x")
# calculate the interdecile ranges
# Intercept
dec90 <- quantile(cc2$`(Intercept)`,probs=c(.9))
dec10 <- quantile(cc2$`(Intercept)`,probs=c(.1))
print("Intercept interdecile range")
dec90-dec10
# Slopes
dec90 <- quantile(cc2$inc,probs=c(.9))
dec10 <- quantile(cc2$inc,probs=c(.1))
print("Slope interdecile range")
dec90-dec10
# extract the blups
cc2 <- coef(mix_yld1)$study
cc2 %>%
gather("coef", "value") %>%
ggplot(aes(x=value))+
geom_histogram(bins = 10)+
facet_wrap(~coef, scales = "free_x")
# calculate the interdecile ranges
# Intercept
dec90 <- quantile(cc2$`(Intercept)`,probs=c(.9))
dec10 <- quantile(cc2$`(Intercept)`,probs=c(.1))
print("Intercept interdecile range")
dec90-dec10
# Slopes
dec90 <- quantile(cc2$inc,probs=c(.9))
dec10 <- quantile(cc2$inc,probs=c(.1))
print("Slope interdecile range")
dec90-dec10
# extract the blups
cc2 <- coef(mix_yld1)$study
cc2 %>%
gather("coef", "value") %>%
ggplot(aes(x=value))+
geom_histogram(bins = 10, fill = "grey80", color = "grey50")+
facet_wrap(~coef, scales = "free_x")
# calculate the interdecile ranges
# Intercept
dec90 <- quantile(cc2$`(Intercept)`,probs=c(.9))
dec10 <- quantile(cc2$`(Intercept)`,probs=c(.1))
print("Intercept interdecile range")
dec90-dec10
# Slopes
dec90 <- quantile(cc2$inc,probs=c(.9))
dec10 <- quantile(cc2$inc,probs=c(.1))
print("Slope interdecile range")
dec90-dec10
# extract the blups
cc2 <- coef(mix_yld1)$study
cc2 %>%
gather("coef", "value") %>%
ggplot(aes(x=value))+
theme_minimal()+
geom_histogram(bins = 10, fill = "grey80", color = "grey50")+
facet_wrap(~coef, scales = "free_x")
# calculate the interdecile ranges
# Intercept
dec90 <- quantile(cc2$`(Intercept)`,probs=c(.9))
dec10 <- quantile(cc2$`(Intercept)`,probs=c(.1))
print("Intercept interdecile range")
dec90-dec10
# Slopes
dec90 <- quantile(cc2$inc,probs=c(.9))
dec10 <- quantile(cc2$inc,probs=c(.1))
print("Slope interdecile range")
dec90-dec10
cc2
cc2 %>%
mutate(study = seq(nrow(cc2)))
# extract the blups
cc2 <- coef(mix_yld1)$study
cc2 %>%
mutate(study = seq(nrow(cc2))) %>%
gather("coef", "value") %>%
ggplot(aes(x=value))+
theme_minimal()+
geom_histogram(bins = 10, fill = "grey80", color = "grey50")+
facet_wrap(~coef, scales = "free_x")
cc2 %>%
gather("coef", "value") %>%
mutate(study = seq(nrow(cc2))) %>%
ggplot(aes(inc, yld))+
geom_smooth(method="lm", fullrange=TRUE, se=F, size=0.7, color="grey80", aes(group = factor(study)))+
geom_point(alpha = 0.5, shape = 1)+
ylab("Yield (kg/ha)")+
xlab("White mold incidence (%)")+
theme_minimal()
cc2 %>%
gather("coef", "value") %>%
mutate(study = seq(nrow(cc2))) %>%
ggplot(aes(inc, yld, group = study))+
geom_abline()+
ylab("Yield (kg/ha)")+
xlab("White mold incidence (%)")+
theme_minimal()
cc2 %>%
gather("coef", "value") %>%
mutate(study = seq(nrow(cc2)))
cc2 %>%
gather("coef", "value") %>%
mutate(study = seq(nrow(cc2)))
cc2 %>%
gather("coef", "value")
cc2 %>%
mutate(study = seq(nrow(cc2)))
cc2 %>%
mutate(study = seq(nrow(cc2))) %>%
ggplot(aes(inc, yld, group = study))+
geom_abline()+
ylab("Yield (kg/ha)")+
xlab("White mold incidence (%)")+
theme_minimal()
cc2 %>%
mutate(study = seq(nrow(cc2)))
cc2 %>%
mutate(study = seq(nrow(cc2))) %>%
ggplot(aes(group = study))+
geom_abline()+
ylab("Yield (kg/ha)")+
xlab("White mold incidence (%)")+
theme_minimal()
# extract the blups
cc2 <- coef(mix_yld1)$study
cc2 %>%
gather("coef", "value") %>%
ggplot(aes(x=value))+
theme_minimal()+
geom_histogram(bins = 10, fill = "grey80", color = "grey50")+
facet_wrap(~coef, scales = "free_x")
library(lme4)
# random intercept and slopes
mix_yld1  <- lmer(yld ~ inc + (inc |study), data=dat_yld, REML=F)
# random slopes
mix_yld2 <- lmer(yld ~ inc + (1 | inc), data=dat_yld, REML=F)
# random intercepts
mix_yld3 <- lmer(yld ~ inc + (1 |study), data=dat_yld, REML=F)
AIC(mix_yld1, mix_yld2, mix_yld3)
AIC(mix_scl1, mix_scl2, mix_scl3)
plot(mix_scl1,type=c("p","smooth"))
library(lattice)
qqmath(mix_scl1)
plot(fitted(mix_scl1)~dat_scl$scl)
vc_scl <- VarCorr(mix_scl1)
## variance only
as.data.frame(vc_scl, order="lower.tri")
# extract the blups
cc2_scl <- coef(mix_scl1)$study
cc2_scl %>%
gather("coef", "value") %>%
ggplot(aes(x=value))+
theme_minimal()+
geom_histogram(bins = 10, fill = "grey80", color = "grey50")+
facet_wrap(~coef, scales = "free_x")
library(lme4)
# random intercept and slopes
mix_scl1  <- lmer(scl ~ inc + (inc |study), data=dat_scl, REML=F)
mix_scl2 <- lmer(scl ~ inc + (1 | inc), data=dat_scl, REML=F)
mix_scl3 <- lmer(scl ~ inc + (1 |study), data=dat_scl, REML=F)
# extract the blups
cc2_scl <- coef(mix_scl1)$study
cc2_scl %>%
gather("coef", "value") %>%
ggplot(aes(x=value))+
theme_minimal()+
geom_histogram(bins = 10, fill = "grey80", color = "grey50")+
facet_wrap(~coef, scales = "free_x")
cc2_scl <- coef(mix_scl1)$study
cc2_scl %>%
gather("coef", "value") %>%
ggplot(aes(x=value))+
theme_minimal()+
geom_histogram(bins = 10, fill = "grey80", color = "grey50")+
facet_wrap(~coef, scales = "free_x")
mix_yld1  <- lmer(yld ~ inc + (inc |study), data=dat_yld, REML=F)
summary (mix_yld1)
summary (mix_scl1)
